<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®ç§¯åˆ†é¢˜ç›®å¿«é€Ÿå½•å…¥å·¥å…·</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 30px;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        textarea {
            min-height: 80px;
            font-family: 'Courier New', monospace;
        }
        .options-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        .option-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .option-label {
            width: 30px;
            font-weight: bold;
            color: #4CAF50;
        }
        .option-input {
            flex: 1;
        }
        .correct-option {
            background: #e8f5e9;
            border-color: #4CAF50;
        }
        .preview {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-top: 20px;
        }
        .preview h3 {
            margin-bottom: 10px;
            color: #666;
        }
        .preview-content {
            background: white;
            padding: 15px;
            border-radius: 4px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #4CAF50;
            color: white;
        }
        .btn-primary:hover {
            background: #45a049;
        }
        .btn-secondary {
            background: #2196F3;
            color: white;
        }
        .btn-secondary:hover {
            background: #0b7dda;
        }
        .btn-clear {
            background: #f44336;
            color: white;
        }
        .btn-clear:hover {
            background: #da190b;
        }
        .json-output {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .tips {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .tips h3 {
            color: #1976D2;
            margin-bottom: 10px;
        }
        .tips ul {
            margin-left: 20px;
        }
        .tips li {
            margin-bottom: 5px;
            color: #555;
        }
        .shortcuts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .shortcut-btn {
            padding: 8px 12px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
        }
        .shortcut-btn:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ å¾®ç§¯åˆ†é¢˜ç›®å¿«é€Ÿå½•å…¥å·¥å…·</h1>

        <div class="tips">
            <h3>ğŸ’¡ å¿«é€Ÿå½•å…¥æŠ€å·§</h3>
            <ul>
                <li><strong>LaTeX æ ¼å¼ï¼š</strong>æ•°å­¦å…¬å¼ç”¨ $...$ åŒ…è£¹ï¼Œå¦‚ $x^2 + 3x + 2$</li>
                <li><strong>å¿«é€Ÿå¤åˆ¶ï¼š</strong>ç‚¹å‡»"å¤åˆ¶ JSON"æŒ‰é’®ï¼Œç›´æ¥ç²˜è´´åˆ° problems.json</li>
                <li><strong>æ‰¹é‡å½•å…¥ï¼š</strong>å½•å…¥å®Œä¸€é“é¢˜åï¼Œç‚¹å‡»"æ¸…ç©ºè¡¨å•"ç»§ç»­å½•å…¥ä¸‹ä¸€é¢˜</li>
                <li><strong>é¢„è§ˆåŠŸèƒ½ï¼š</strong>å®æ—¶é¢„è§ˆé¢˜ç›®æ˜¾ç¤ºæ•ˆæœï¼Œç¡®ä¿æ ¼å¼æ­£ç¡®</li>
            </ul>
        </div>

        <form id="problemForm">
            <div class="form-group">
                <label>ä¸»é¢˜ *</label>
                <select id="topic" required>
                    <option value="å¯¼æ•°åŸºç¡€">å¯¼æ•°åŸºç¡€</option>
                    <option value="æé™ä¸è¿ç»­">æé™ä¸è¿ç»­</option>
                    <option value="ç§¯åˆ†">ç§¯åˆ†</option>
                    <option value="å¾®åˆ†æ–¹ç¨‹">å¾®åˆ†æ–¹ç¨‹</option>
                    <option value="çº§æ•°">çº§æ•°</option>
                    <option value="å¤šå…ƒå‡½æ•°">å¤šå…ƒå‡½æ•°</option>
                    <option value="å‘é‡åˆ†æ">å‘é‡åˆ†æ</option>
                </select>
            </div>

            <div class="form-group">
                <label>éš¾åº¦ *</label>
                <select id="difficulty" required>
                    <option value="åŸºç¡€">åŸºç¡€</option>
                    <option value="è¿›é˜¶">è¿›é˜¶</option>
                </select>
            </div>

            <div class="form-group">
                <label>é¢˜ç›®å†…å®¹ (LaTeX æ ¼å¼) *</label>
                <textarea id="question" placeholder="ä¾‹å¦‚: æ±‚å‡½æ•° $f(x) = x^2 + 3x + 2$ çš„å¯¼æ•°ã€‚" required></textarea>
                <div class="shortcuts">
                    <button type="button" class="shortcut-btn" onclick="insertText('question', '$x^2$')">xÂ²</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('question', '$\\frac{a}{b}$')">åˆ†æ•°</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('question', '$\\sin(x)$')">sin</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('question', '$\\cos(x)$')">cos</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('question', '$\\lim_{x \\to 0}$')">æé™</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('question', '$\\int$')">ç§¯åˆ†</button>
                </div>
            </div>

            <div class="form-group">
                <label>é€‰é¡¹ (LaTeX æ ¼å¼) *</label>
                <div class="options-group">
                    <div class="option-item">
                        <span class="option-label">A:</span>
                        <input type="text" id="optionA" class="option-input" placeholder="é€‰é¡¹A" required>
                        <input type="radio" name="correctAnswer" value="A" checked>
                    </div>
                    <div class="option-item">
                        <span class="option-label">B:</span>
                        <input type="text" id="optionB" class="option-input" placeholder="é€‰é¡¹B" required>
                        <input type="radio" name="correctAnswer" value="B">
                    </div>
                    <div class="option-item">
                        <span class="option-label">C:</span>
                        <input type="text" id="optionC" class="option-input" placeholder="é€‰é¡¹C" required>
                        <input type="radio" name="correctAnswer" value="C">
                    </div>
                    <div class="option-item">
                        <span class="option-label">D:</span>
                        <input type="text" id="optionD" class="option-input" placeholder="é€‰é¡¹D" required>
                        <input type="radio" name="correctAnswer" value="D">
                    </div>
                </div>
                <small style="color: #666;">ğŸ’¡ ç‚¹å‡»å•é€‰æŒ‰é’®é€‰æ‹©æ­£ç¡®ç­”æ¡ˆ</small>
            </div>

            <div class="form-group">
                <label>è§£ç­”è¿‡ç¨‹ (LaTeX æ ¼å¼ï¼Œä½¿ç”¨ \n æ¢è¡Œ) *</label>
                <textarea id="solution" placeholder="ä¾‹å¦‚: ä½¿ç”¨åŸºæœ¬æ±‚å¯¼æ³•åˆ™ï¼š\n$f'(x) = 2x + 3$" required></textarea>
                <div class="shortcuts">
                    <button type="button" class="shortcut-btn" onclick="insertText('solution', '\\n')">æ¢è¡Œ</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('solution', '$f'(x)$')">å¯¼æ•°</button>
                    <button type="button" class="shortcut-btn" onclick="insertText('solution', '$\\frac{d}{dx}$')">d/dx</button>
                </div>
            </div>

            <div class="form-group">
                <label>æ ‡ç­¾ (ç”¨é€—å·åˆ†éš”)</label>
                <input type="text" id="tags" placeholder="ä¾‹å¦‚: å¯¼æ•°, å¤šé¡¹å¼">
            </div>

            <div class="button-group">
                <button type="button" class="btn-primary" onclick="generateJSON()">ç”Ÿæˆ JSON</button>
                <button type="button" class="btn-secondary" onclick="copyJSON()">å¤åˆ¶ JSON</button>
                <button type="button" class="btn-secondary" onclick="previewProblem()">é¢„è§ˆé¢˜ç›®</button>
                <button type="button" class="btn-clear" onclick="clearForm()">æ¸…ç©ºè¡¨å•</button>
            </div>
        </form>

        <div id="jsonOutput" style="display: none;">
            <h3>ç”Ÿæˆçš„ JSON:</h3>
            <div class="json-output" id="jsonContent"></div>
        </div>

        <div id="preview" class="preview" style="display: none;">
            <h3>é¢˜ç›®é¢„è§ˆ:</h3>
            <div class="preview-content" id="previewContent"></div>
        </div>
    </div>

    <script>
        function insertText(elementId, text) {
            const element = document.getElementById(elementId);
            const start = element.selectionStart;
            const end = element.selectionEnd;
            const value = element.value;
            element.value = value.substring(0, start) + text + value.substring(end);
            element.focus();
            element.setSelectionRange(start + text.length, start + text.length);
        }

        function generateJSON() {
            const topic = document.getElementById('topic').value;
            const difficulty = document.getElementById('difficulty').value;
            const question = document.getElementById('question').value.trim();
            const optionA = document.getElementById('optionA').value.trim();
            const optionB = document.getElementById('optionB').value.trim();
            const optionC = document.getElementById('optionC').value.trim();
            const optionD = document.getElementById('optionD').value.trim();
            const solution = document.getElementById('solution').value.trim();
            const tags = document.getElementById('tags').value.split(',').map(t => t.trim()).filter(t => t);
            const correctAnswer = document.querySelector('input[name="correctAnswer"]:checked').value;

            // é‡æ–°æ’åºé€‰é¡¹ï¼Œä½¿æ­£ç¡®ç­”æ¡ˆåœ¨ç¬¬ä¸€ä¸ªä½ç½®
            const options = [optionA, optionB, optionC, optionD];
            const correctIndex = correctAnswer.charCodeAt(0) - 65;
            const correctOption = options[correctIndex];
            const otherOptions = options.filter((_, i) => i !== correctIndex);
            const sortedOptions = [correctOption, ...otherOptions];

            const problem = {
                "id": "p?",  // éœ€è¦æ‰‹åŠ¨æ›¿æ¢
                "topic": topic,
                "difficulty": difficulty,
                "question": question,
                "answer": "A",  // æ­£ç¡®ç­”æ¡ˆç°åœ¨åœ¨ç¬¬ä¸€ä¸ªä½ç½®
                "options": sortedOptions,
                "solution": solution,
                "tags": tags
            };

            const jsonStr = JSON.stringify(problem, null, 2);
            document.getElementById('jsonContent').textContent = jsonStr;
            document.getElementById('jsonOutput').style.display = 'block';

            // æ»šåŠ¨åˆ°è¾“å‡ºåŒºåŸŸ
            document.getElementById('jsonOutput').scrollIntoView({ behavior: 'smooth' });
        }

        function copyJSON() {
            const jsonContent = document.getElementById('jsonContent').textContent;
            navigator.clipboard.writeText(jsonContent).then(() => {
                alert('âœ… JSON å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\nç°åœ¨å¯ä»¥ï¼š\n1. æ‰“å¼€ assets/data/problems.json\n2. æ‰¾åˆ°æœ€åä¸€ä¸ªé¢˜ç›®ï¼Œè·å–ä¸‹ä¸€ä¸ª ID\n3. æ›¿æ¢ "p?" ä¸ºæ­£ç¡®çš„ ID\n4. ç²˜è´´åˆ°æ•°ç»„ä¸­');
            }).catch(err => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶');
            });
        }

        function previewProblem() {
            const question = document.getElementById('question').value;
            const optionA = document.getElementById('optionA').value;
            const optionB = document.getElementById('optionB').value;
            const optionC = document.getElementById('optionC').value;
            const optionD = document.getElementById('optionD').value;
            const solution = document.getElementById('solution').value;
            const correctAnswer = document.querySelector('input[name="correctAnswer"]:checked').value;

            let html = `
                <div style="margin-bottom: 20px;">
                    <strong>é¢˜ç›®ï¼š</strong>
                    <div style="margin-top: 10px; padding: 15px; background: #f5f5f5; border-radius: 4px;">
                        ${question}
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <strong>é€‰é¡¹ï¼š</strong>
                    <div style="margin-top: 10px;">
                        <div style="padding: 10px; margin: 5px 0; border-radius: 4px; ${correctAnswer === 'A' ? 'background: #e8f5e9; border: 2px solid #4CAF50;' : 'background: #fff; border: 1px solid #ddd;'}">
                            <strong>A:</strong> ${optionA} ${correctAnswer === 'A' ? 'âœ“' : ''}
                        </div>
                        <div style="padding: 10px; margin: 5px 0; border-radius: 4px; ${correctAnswer === 'B' ? 'background: #e8f5e9; border: 2px solid #4CAF50;' : 'background: #fff; border: 1px solid #ddd;'}">
                            <strong>B:</strong> ${optionB} ${correctAnswer === 'B' ? 'âœ“' : ''}
                        </div>
                        <div style="padding: 10px; margin: 5px 0; border-radius: 4px; ${correctAnswer === 'C' ? 'background: #e8f5e9; border: 2px solid #4CAF50;' : 'background: #fff; border: 1px solid #ddd;'}">
                            <strong>C:</strong> ${optionC} ${correctAnswer === 'C' ? 'âœ“' : ''}
                        </div>
                        <div style="padding: 10px; margin: 5px 0; border-radius: 4px; ${correctAnswer === 'D' ? 'background: #e8f5e9; border: 2px solid #4CAF50;' : 'background: #fff; border: 1px solid #ddd;'}">
                            <strong>D:</strong> ${optionD} ${correctAnswer === 'D' ? 'âœ“' : ''}
                        </div>
                    </div>
                </div>
                <div>
                    <strong>è§£ç­”ï¼š</strong>
                    <div style="margin-top: 10px; padding: 15px; background: #e3f2fd; border-radius: 4px; white-space: pre-wrap;">
                        ${solution}
                    </div>
                </div>
            `;

            document.getElementById('previewContent').innerHTML = html;
            document.getElementById('preview').style.display = 'block';

            // é‡æ–°æ¸²æŸ“ MathJax
            if (window.MathJax) {
                MathJax.typesetPromise([document.getElementById('previewContent')]);
            }

            // æ»šåŠ¨åˆ°é¢„è§ˆåŒºåŸŸ
            document.getElementById('preview').scrollIntoView({ behavior: 'smooth' });
        }

        function clearForm() {
            document.getElementById('problemForm').reset();
            document.getElementById('jsonOutput').style.display = 'none';
            document.getElementById('preview').style.display = 'none';
            document.querySelector('input[name="correctAnswer"][value="A"]').checked = true;
        }

        // å®æ—¶é¢„è§ˆï¼ˆå¯é€‰ï¼‰
        document.getElementById('question').addEventListener('input', () => {
            if (document.getElementById('preview').style.display === 'block') {
                previewProblem();
            }
        });
    </script>
</body>
</html>

