# 大学数学衔接题库：低成本自动判题方案说明书

> 目标：  
> 为「高中 → 大学数学衔接」的刷题 App 设计一套 **以基础概念为主、成本最低、可自动判分** 的技术与题目结构方案。  
> 后端主要使用 **Python + SymPy**，不引入复杂的几何自动证明系统。

---

## 1. 设计总原则

1. **重基础、重概念，不卷难度**
   - 面向对象：高中毕业、即将上大学 / 正在上大一的学生
   - 主要任务：补齐基本概念、公式、典型思路，为高数打基础

2. **优先使用 SymPy 擅长的领域**
   - 三角函数、代数方程、排列组合、复数、参数方程与极坐标
   - 这些部分可以用 SymPy 稳定生成/校验答案

3. **平面几何尽量“解析化、坐标化”**
   - 概念用选择题解决
   - 计算题尽量转为“坐标系中的长度、面积、斜率”等

4. **不做复杂“过程评分”**
   - 解答题只判“最终答案是否正确”
   - 步骤得分不自动评，靠标准解析 + 学生自我对照

5. **题目结构要能支持自动判分**
   - 题型尽量设计为：  
     - 选择题：比对选项  
     - 填空题：数值/表达式  
     - 解答题：有明确的最终结果可检验

---

## 2. 难度与题型体系

### 2.1 难度等级

统一使用三档难度标签：

- **L1：基础题**
  - 考点：概念、定义、直接套公式的计算
  - 步骤：1–2 步
- **L2：提升题**
  - 考点：公式运用、方法选择、2–4 步推导
- **L3：挑战题**
  - 考点：综合应用、证明/建模、压轴题风格

建议题库总体比例：

- L1：**50%**
- L2：**35%**
- L3：**15%**

### 2.2 题型类型

- **选择题（choice）**  
- **填空题（fill）**  
- **解答题（solution）**

题型与难度的建议配比：

#### L1 基础题：

- 选择题：60%  
- 填空题：30%  
- 解答题：10%

#### L2 提升题：

- 选择题：30%  
- 填空题：40%  
- 解答题：30%

#### L3 挑战题：

- 选择题：10%  
- 填空题：30%  
- 解答题：60%

> 解释：  
> - 基础 → 很多“概念/基础运算”，适合做成选择题  
> - 提升 → 更多填空/解答题，训练完整解题过程  
> - 挑战 → 以解答题为主，用于综合训练与拉高上限

---

## 3. SymPy 的角色与适用范围

### 3.1 SymPy 特别擅长的模块

这些模块可以高度依赖 SymPy 进行 **出题辅助 + 自动判分**：

1. **三角函数 & 反三角函数（第 1、4 章）**
   - 三角化简、恒等式判断
   - 三角方程、反三角方程求解
   - 使用 `simplify` / `trigsimp` 检查表达式等价性

2. **代数与方程（第 2 章）**
   - 多项式展开与因式分解 `expand`, `factor`
   - 方程求解 `solve` / `roots`
   - 判解的个数、特定参数条件

3. **排列组合 & 二项式定理（第 5 章）**
   - 使用 `factorial`, `binomial`
   - 计算组合数、二项式展开的某项系数

4. **复数（第 6 章）**
   - 实部、虚部、模、辐角：`re`, `im`, `Abs`, `arg`
   - 复数运算、极坐标形式、指数形式

5. **参数方程与极坐标（第 7 章）**
   - 消元得到轨迹方程
   - 判断点是否在曲线上
   - 求导数/斜率等（如有需要）

> 这些章节的 **选择题、填空题、解答题的最终答案**，都可以用 SymPy 自动生成与校验。

### 3.2 平面几何相关能力

SymPy 有 `sympy.geometry` 模块：

- `Point`, `Line`, `Segment`, `Circle`, `Triangle`, `Polygon` 等
- 能做：
  - 点在不在某个几何对象上
  - 长度、面积、交点、斜率等计算
- 不能自动做：
  - 对学生的几何证明过程进行推理分析与评分

**结论：**

- 适合：  
  - 几何的选择题/填空题的 **数值类结果** 判分  
- 不适合：  
  - 几何证明题的“过程评分”，这一块不建议自动化

---

## 4. 平面几何的低成本处理方案

### 4.1 几何概念题 → 全部选择题

例如：

- 判断某个图形是不是平行四边形 / 菱形 / 矩形  
- 圆心角、内接角、切线性质的判断  
- 相似三角形的条件、平行线性质

**处理方式：**

- 出题时由人工设计题干与选项  
- 后端只存正确选项下标  
- 判分直接比对，不用几何库

### 4.2 几何计算题 → 尽量“解析几何化”

例如：

- 给三角形 ABC 的顶点坐标：A(0, 0), B(2, 0), C(1, √3)
  - 求边长 AB, AC, BC  
  - 求面积  
  - 判定是否直角/等腰/等边

**处理方式：**

1. 将几何问题转成坐标系中的代数问题  
2. 用 SymPy 计算标准结果  
3. 学生给出坐标/长度/面积等 → 数值对比（允许少量误差）

### 4.3 几何证明题 → 不自动评分

对于需要写完整证明的题：

- 在 App 中作为「**阅读 + 自练**」内容：
  - 提供题干和标准证明解析
  - 不计入自动评分或只记为“自我完成度打分”
- 系统不尝试解析学生的证明文本

---

## 5. 三种题型的判分策略（结合 SymPy）

### 5.1 选择题（choice）

- **存储：**
  - `options`: 选项列表
  - `correctIndex`: 正确答案的下标
- **判分：**
  - 用户选项 index == `correctIndex` → 正确
- **SymPy 只在出题阶段辅助生成正确答案 & 迷惑项**

> 对系统来说，选择题的判分成本几乎为 0。

---

### 5.2 填空题（fill）

将填空题分成两类：

#### 5.2.1 简单结果题（整数/分数/有限小数）

- 例如：
  - 解的个数：`0, 1, 2`
  - 某个组合数：`120`
  - 某个极限：`1`, `0`, `e`

**判分方式：**

- 将用户输入解析为数值类型（int/float）  
- 与标准答案做数值比较（允许一定误差）

#### 5.2.2 表达式等价题

- 例如：
  - `(x+1)^2` 与 `x^2 + 2x + 1`
  - `sin^2 x + cos^2 x` 与 `1`
  - 某个极限表达式的最终形式

**判分方式（伪代码）：**

1. 使用 `sympy.parsing.sympy_parser.parse_expr()` 将用户输入转为表达式
2. 标准答案同样是表达式字符串
3. 使用：
   - `simplify(user_expr - correct_expr)` 看是否为 0  
   **或**
   - 代入多个随机值做数值对比（注意定义域）

---

### 5.3 解答题（solution）

**低成本策略：只判“最终答案”是否正确。**

- 每道解答题有一个 `finalAnswerExpr` 字段  
  - 比如：最终要求的根、区间、面积、函数表达式等
- 判分流程：
  1. 提示学生：**必须在最后写出一个明确答案表达式/数值**
  2. 后端用 SymPy 检查：
     - 用户最终答案与标准答案是否等价
- 标准解析：
  - 存储完整解答过程作为参考，学生自我对照

> 不尝试自动分析每一步推导，不做过程部分分。

---

## 6. 各章节的设计侧重点（结合低成本策略）

### 第 1、4 章：三角函数 & 反三角函数

- 重点：概念、图像、常用公式、基本方程
- 题型结构：
  - 概念：选择题（定义域、值域、单调、周期等）
  - 计算：填空题 + 少量解答题（只判最终值/表达式）
- SymPy 能力：三角化简、解方程、判断表达式等价

### 第 2 章：代数与方程

- 重点：代数运算、一元方程、高次方程的一元化思路
- 题型结构：
  - 大量 L1/L2 选择题 + 填空题（判根、判别式、根的性质）
  - 解答题：只判最终解集/参数范围（SymPy）

### 第 3 章：平面几何

- 概念 → 选择题  
- 计算 → 尽量坐标化，使用代数/向量、SymPy 判分  
- 证明 → 用于阅读训练，不自动评分

### 第 5 章：排列组合 & 二项式 & 归纳法

- 选择题/填空覆盖绝大多数考点  
- 归纳法证明：
  - 作为“阅读型解答题”，给出完整解析
  - 不做复杂自动评分

### 第 6 章：复数

- 运算、模、辐角 → 填空题 + 选择题
- 复杂形式、几何意义 → 解答题只判最终表达式

### 第 7 章：参数方程与极坐标方程

- 重点：基础参数/极坐标表示、简单曲线性质
- 题目设计：
  - 选择题：判断某方程对应的图形
  - 填空题：写出参数方程/极坐标方程
  - 解答题：轨迹方程、特定点/斜率/距离的计算（SymPy 判）

---

## 7. 后端数据结构与判分接口示例（逻辑设计）仅供参考

### 7.1 枚举类型

```python
from enum import Enum

class ProblemType(str, Enum):
    CHOICE = "choice"
    FILL = "fill"
    SOLUTION = "solution"

class Difficulty(str, Enum):
    L1 = "L1"
    L2 = "L2"
    L3 = "L3"

7.2 题目存储结构（示意）
problem_record = {
    "id": "5.2.003",
    "chapterId": "5.2",          # 第5章 第2节 排列
    "type": "fill",              # choice / fill / solution
    "difficulty": "L2",

    "text": "从 10 人中选出 3 人，有多少种选法？",
    "options": None,             # choice 用
    "correctIndex": None,        # choice 用

    "answerExpr": "binomial(10, 3)",  # 给 SymPy 用的表达式字符串
    "answerType": "integer",          # integer / float / expr

    "tags": ["排列组合", "计数基础"],
    "explanation": "... 解析文本/LaTeX ...",  # Pro 可完整展示
}

7.3 判分流程（简要逻辑）

对于 选择题（choice）：

直接比对 userChoiceIndex == correctIndex

对于 填空题（fill）：

若 answerType == "integer" / "float"：

转数值比较（带容差）

若 answerType == "expr"：

用 SymPy 解析 answerExpr 与用户表达式等价性

对于 解答题（solution）：

与填空题的表达式比较逻辑类似，只检验最终答案字段

8. 实施路线建议（分步上线）

第一阶段：三角 + 代数 + 排列组合 + 复数 + 参数/极坐标

先把这些 SymPy 擅长的模块打通

做出：选择题 + 填空题 + 解答题最终答案判分

第二阶段：平面几何基础题

概念：选择题上线

计算：尽量用“坐标/向量化”的题，配合 SymPy 判分

第三阶段：几何证明 & 归纳法证明等

作为“阅读＋自我训练”内容

不进入主评分体系

9. 一句话总结

对于“大学数学衔接、重基础概念”的刷题 App，用 SymPy 做数值/表达式判分 + 精心设计题目结构，
就足以覆盖绝大多数章节的自动判分需求。
不需要引入重型几何证明库，也不必做复杂过程评分，这是在「效果」与「开发成本」之间的最优平衡。
体验上可以再优化的点

如果你决定用两个 Tab，可以考虑：

默认打开「选择填空」

因为一般做题也是从前面开始做。

在提交前做一次检查

比如点击「交卷」时弹窗提示：

选择填空：10/10 题已作答
解答题：2/3 题已作答
确定要交卷吗？

记住每个 Tab 的滚动位置

用户在解答题滚到中间，切回选择题再回来时，尽量回到原来的位置，体验会好很多。在交互上提醒好「还有另一个 Tab 需要完成」，并在交卷时帮用户检查有没有漏题